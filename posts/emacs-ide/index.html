<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Building an Intelligent Emacs" /><meta name="author" content="Ian Y.E. Pan" /><meta property="og:locale" content="en_US" /><meta name="description" content="This post introduces the combination of Emacs and LSP, and how you can make your own editor “smarter” by using the same idea of communications between an editor client and multiple language servers. Edit: Thank you for the support, this blog post got featured on the front page of Hacker News (YCombinator)." /><meta property="og:description" content="This post introduces the combination of Emacs and LSP, and how you can make your own editor “smarter” by using the same idea of communications between an editor client and multiple language servers. Edit: Thank you for the support, this blog post got featured on the front page of Hacker News (YCombinator)." /><link rel="canonical" href="https://ianyepan.github.io/posts/emacs-ide/" /><meta property="og:url" content="https://ianyepan.github.io/posts/emacs-ide/" /><meta property="og:site_name" content="Ian Y.E. Pan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-11T09:18:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Building an Intelligent Emacs" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Ian Y.E. Pan" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ian Y.E. Pan"},"dateModified":"2022-09-03T01:03:39+08:00","datePublished":"2022-02-11T09:18:00+08:00","description":"This post introduces the combination of Emacs and LSP, and how you can make your own editor “smarter” by using the same idea of communications between an editor client and multiple language servers. Edit: Thank you for the support, this blog post got featured on the front page of Hacker News (YCombinator).","headline":"Building an Intelligent Emacs","mainEntityOfPage":{"@type":"WebPage","@id":"https://ianyepan.github.io/posts/emacs-ide/"},"url":"https://ianyepan.github.io/posts/emacs-ide/"}</script><title>Building an Intelligent Emacs | Ian Y.E. Pan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ian Y.E. Pan"><meta name="application-name" content="Ian Y.E. Pan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/36686900?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ian Y.E. Pan</a></div><div class="site-subtitle font-italic">software engineer, emacs enthusiast, keyboard lover. occasionally nerdy.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ianyepan" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/ianyepan/" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ian.pan','columbia.edu'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always use light mode by default: Experimental */ /* self.setLight(); */ /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Building an Intelligent Emacs</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Building an Intelligent Emacs</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Ian Y.E. Pan </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Feb 11, 2022, 9:18 AM +0800" prep="on" > Feb 11, 2022 <i class="unloaded">2022-02-11T09:18:00+08:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Sep 2, 2022, 1:03 PM -0400" prefix="Updated " > Sep 2, 2022 <i class="unloaded">2022-09-03T01:03:39+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1357 words">7 min</span></div></div><div class="post-content"><blockquote><p>This post introduces the combination of Emacs and LSP, and how you can make your own editor “smarter” by using the same idea of communications between an editor client and multiple language servers.</p><p><strong>Edit</strong>: Thank you for the support, this blog post got featured on the front page of Hacker News (YCombinator).</p></blockquote><h2 id="background">Background</h2><p>When compared with modern editors and IDEs (such as IntelliJ IDEA, PyCharm, and Visual Studio Code), old-school editors like Emacs or Vim fail to provide intelligent actions such as “auto-complete (Intellisense)”, “go to definition/references”, and “on-the-fly error checking” <strong>out-of-the-box</strong>. After all, this requires a deep understanding of both the programming language and the code, which is the main reason why IDEs are created in the first place.</p><h2 id="language-server-protocol-lsp">Language Server Protocol (LSP)</h2><p>That said, everything changed when Microsoft released its development of the <a href="https://microsoft.github.io/language-server-protocol/">Language Server Protocol</a>. In short, LSP decouples the tooling into servers and clients, with the former powering all the intelligent activities, and the latter being integrated into any development tool of your choice. If you’d like to read more about the inner workings, consider <a href="https://microsoft.github.io/language-server-protocol/overviews/lsp/overview/">this post</a>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/emacs-ide1.png" alt="Emacs1" width="90%" /> <em>Emacs showing language-aware auto-completion powered by the clangd language server. Company and company-box are used to provide the auto-completion UI.</em></p><p>All of a sudden, as long as you have a client in your editor that can communicate with the language servers, which are separately downloaded, any tool can become as intelligent and feature-rich as the popular IDEs and smart editors. In other words, if my “primitive” editor has a thin layer of a client that can communicate with, say, the Java language server of the Eclipse IDE, my editor can obtain all the smart features that are exposed by the server and instantly be on par with Eclipse. Similarly, if I install the same language server that powers the sweet code actions for TypeScript/JavaScript in VSCode and hooks it to my editor’s client, I wouldn’t lose anything by not using VSCode.</p><h2 id="clients-for-lsp">Clients for LSP</h2><p>In the Vim/Neovim world, the main players are <a href="https://github.com/neoclide/coc.nvim">CoC</a> and the <a href="https://github.com/neovim/nvim-lspconfig">native LSP client</a> of Neovim. In the Emacs community, the equivalent would be <a href="https://github.com/emacs-lsp/lsp-mode">lsp-mode</a> and <a href="https://github.com/joaotavora/eglot">eglot</a>. As an Emacs user, I have tried out both lsp-mode and eglot, and found the former more configurable, feature-rich, and easy to wrap my head about. In the rest of this post, I will be using lsp-mode as my client to demonstrate the configurations of making Emacs an intelligent editor.</p><p>To install lsp-mode from MELPA for Emacs, you can use the following use-package declaration. If you need help setting up use-package, I also <a href="../setting-up-use-package">wrote a post</a> on this topic.</p><div class="language-emacs-lisp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">(</span><span class="nb">use-package</span> <span class="nv">lsp-mode</span>
  <span class="ss">:hook</span> <span class="p">((</span><span class="nv">X-mode</span> <span class="nv">Y-mode</span> <span class="nv">Z-mode</span><span class="p">)</span> <span class="o">.</span> <span class="nv">lsp-deferred</span><span class="p">)</span> <span class="c1">; XYZ are to be replaced by python, c++, etc.</span>
  <span class="ss">:commands</span> <span class="nv">lsp</span><span class="p">)</span>
</pre></table></code></div></div><p>If we want to enable LSP for C++, Python, Java, and JavaScript, we would write:</p><div class="language-emacs-lisp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">(</span><span class="nb">use-package</span> <span class="nv">lsp-mode</span>
  <span class="ss">:hook</span> <span class="p">((</span><span class="nv">c++-mode</span> <span class="nv">python-mode</span> <span class="nv">java-mode</span> <span class="nv">js-mode</span><span class="p">)</span> <span class="o">.</span> <span class="nv">lsp-deferred</span><span class="p">)</span>
  <span class="ss">:commands</span> <span class="nv">lsp</span><span class="p">)</span>
</pre></table></code></div></div><p>To enable extra information on the sideline (fixes, suggestions, documentation), lsp-mode has an extra companion package called lsp-ui. To enable it, simply do:</p><div class="language-emacs-lisp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="p">(</span><span class="nb">use-package</span> <span class="nv">lsp-ui</span>
  <span class="ss">:commands</span> <span class="nv">lsp-ui-mode</span><span class="p">)</span>
</pre></table></code></div></div><p>I’ve tweaked some settings to enable features that are not set by default, and disabled those that I don’t find helpful:</p><div class="language-emacs-lisp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="p">(</span><span class="nb">use-package</span> <span class="nv">lsp-ui</span>
  <span class="ss">:commands</span> <span class="nv">lsp-ui-mode</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-ui-doc-enable</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-ui-doc-header</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-ui-doc-include-signature</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-ui-doc-border</span> <span class="p">(</span><span class="nv">face-foreground</span> <span class="ss">'default</span><span class="p">))</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-ui-sideline-show-code-actions</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-ui-sideline-delay</span> <span class="mf">0.05</span><span class="p">))</span>
</pre></table></code></div></div><h2 id="servers-for-lsp">Servers for LSP</h2><p>Now that we have the client installed and initialized, we need to provide Emacs with the respective language servers so lsp-mode can pick up the channels of communication. We’ll continue to use C++, Python, Java, and JavaScript as examples since they seem to be the most popular languages.</p><h3 id="setting-up-c">Setting up C++</h3><p>By default, lsp-mode will look for the “clangd” executable on the path. “Clangd” is a language server developed by LLVM (which also develops the clang compilers) and can be downloaded with <code class="language-plaintext highlighter-rouge">brew install llvm</code> on macOS, or <code class="language-plaintext highlighter-rouge">pacman -S clang</code> on Arch.</p><p>Clangd is my choice of language server for both C and C++. If for some reason you don’t like LLVM’s implementation, you can try out <a href="https://github.com/MaskRay/ccls">ccls</a>, an alternative language server for C/C++/ObjC. For lsp-mode to prioritize ccls over clangd, you need to install and set up <a href="https://github.com/emacs-lsp/emacs-ccls">this extra client</a> that leverages lsp-mode.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/emacs-ide2.png" alt="Emacs2" width="90%" /> <em>Emacs detecting typos and suggesting fixes, powered by LSP.</em></p><h3 id="setting-up-python">Setting up Python</h3><p>LSP-mode supports 5 different Python language servers, namely <a href="https://github.com/python-lsp/python-lsp-server">Spyder IDE’s python-lsp-server</a>, the <a href="https://github.com/pappasam/jedi-language-server">Jedi language server</a>, <a href="https://github.com/palantir/python-language-server">Palantir’s pyls</a>, <a href="https://github.com/microsoft/pyright">Microsoft’s Pyright language server</a>, and <a href="https://github.com/Microsoft/python-language-server">Microsoft’s Python language server</a>.</p><p>Pyright is my choice of language server for Python. I’ve heard good things about Sypder IDE’s server but I have yet to try it.</p><p>You can install pyright globally with <code class="language-plaintext highlighter-rouge">pip</code>, <code class="language-plaintext highlighter-rouge">npm</code>, or your system’s package manager. For instance, <code class="language-plaintext highlighter-rouge">pacman -S pyright</code>.</p><p>We will need a thin layer of extra client, <a href="https://emacs-lsp.github.io/lsp-pyright/">lsp-pyright</a>, to sit atop lsp-mode and leverage pyright’s features. The following is the snippet to automatically download the client and set it up. Note that I am using the command <code class="language-plaintext highlighter-rouge">python3</code> as the executable command, in case both Python 2 and 3 are installed on the system.</p><div class="language-emacs-lisp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="p">(</span><span class="nb">use-package</span> <span class="nv">lsp-pyright</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">python-mode</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nb">require</span> <span class="ss">'lsp-pyright</span><span class="p">)))</span>
  <span class="ss">:init</span> <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"python3"</span><span class="p">)</span>
          <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-pyright-python-executable-cmd</span> <span class="s">"python3"</span><span class="p">)))</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/emacs-ide3.png" alt="Emacs3" width="90%" /> <em>Fuzzy match auto-completion in Emacs, powered by lsp-pyright.</em></p><h3 id="setting-up-java">Setting up Java</h3><p>The go-to language server for Java is <a href="https://projects.eclipse.org/projects/eclipse.jdt.ls">Eclipse’s JDT Language Server</a>. We need yet another thin layer of a client called <a href="https://emacs-lsp.github.io/lsp-java/">lsp-java</a> to help leverage lsp-mode and the JDT server. The good news is once you have lsp-java installed in Emacs through use-package, the client will “automatically detect whether the server is missing and download Eclipse JDT Language Server before the first startup”!</p><div class="language-emacs-lisp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="p">(</span><span class="nb">use-package</span> <span class="nv">lsp-java</span>
  <span class="ss">:after</span> <span class="nv">lsp</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="setting-up-javascript">Setting up JavaScript</h3><p>Finally, let’s set up JavaScript for development in Emacs. The recommended language server for JavaScript (and TypeScript) is the conveniently-named <a href="https://github.com/typescript-language-server/typescript-language-server">typescript-language-server</a> (or ts-ls for short), which is a wrapper around Visual Studio Code’s tsserver.</p><p>Since lsp-mode has ts-ls support integrated by default, there’s no need to install an additional thin layer of client on top of lsp-mode. However, we do need to install the language server on our system. We can install it globally with <code class="language-plaintext highlighter-rouge">npm</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm install -g typescript-language-server
</pre></table></code></div></div><h2 id="extra-configuration-for-lsp-mode-optional">Extra Configuration for lsp-mode (Optional)</h2><p>In my opinion, lsp-mode aggressively enables too many features by default, which may result in visual clutter and a slow-down in performance. The following is some of my extra configuration for the lsp-mode client. Whenever you see a pattern of <code class="language-plaintext highlighter-rouge">(setq ... nil)</code>, it means I’m disabling that feature. Towards the bottom of the list, I am also bumping up the chunk-processing threshold to allow for a smoother Emacs experience.</p><div class="language-emacs-lisp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="p">(</span><span class="nb">use-package</span> <span class="nv">lsp-mode</span>
  <span class="ss">:hook</span> <span class="p">((</span><span class="nv">c-mode</span>          <span class="c1">; clangd</span>
          <span class="nv">c++-mode</span>        <span class="c1">; clangd</span>
          <span class="nv">c-or-c++-mode</span>   <span class="c1">; clangd</span>
          <span class="nv">java-mode</span>       <span class="c1">; eclipse-jdtls</span>
          <span class="nv">js-mode</span>         <span class="c1">; ts-ls (tsserver wrapper)</span>
          <span class="nv">js-jsx-mode</span>     <span class="c1">; ts-ls (tsserver wrapper)</span>
          <span class="nv">typescript-mode</span> <span class="c1">; ts-ls (tsserver wrapper)</span>
          <span class="nv">python-mode</span>     <span class="c1">; pyright</span>
          <span class="nv">web-mode</span>        <span class="c1">; ts-ls/HTML/CSS</span>
          <span class="nv">haskell-mode</span>    <span class="c1">; haskell-language-server</span>
          <span class="p">)</span> <span class="o">.</span> <span class="nv">lsp-deferred</span><span class="p">)</span>
  <span class="ss">:commands</span> <span class="nv">lsp</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-auto-guess-root</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-log-io</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-restart</span> <span class="ss">'auto-restart</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-enable-symbol-highlighting</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-enable-on-type-formatting</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-signature-auto-activate</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-signature-render-documentation</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-eldoc-hook</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-modeline-code-actions-enable</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-modeline-diagnostics-enable</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-headerline-breadcrumb-enable</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-semantic-tokens-enable</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-enable-folding</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-enable-imenu</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-enable-snippet</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">read-process-output-max</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">1024</span> <span class="mi">1024</span><span class="p">))</span> <span class="c1">;; 1MB</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">lsp-idle-delay</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></table></code></div></div><h2 id="conclusion">Conclusion</h2><p>Hopefully, this post gives you a good head-start in making Emacs a modern and intelligent IDE. I enjoy the experience of fine-tuning my development environment, even down to hand-picking my own back-end for editor behaviors. I find it extremely satisfying to be putting these pieces together and eventually see them work, as if I’m developing a unique editor configuration that is different from any tool other people use. Of course, this “hobby” isn’t for everybody and if you prefer an out-of-the-box experience to be able to jump straight into the work, then feel free to use any IDE that suits your liking.</p><p>Either way, I’m glad you stumbled upon my post. That’s all for today, cheers!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/emacs/'>Emacs</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/emacs/" class="post-tag no-text-decoration" >emacs</a> <a href="/tags/tutorial/" class="post-tag no-text-decoration" >tutorial</a> <a href="/tags/tips/" class="post-tag no-text-decoration" >tips</a> <a href="/tags/workflow/" class="post-tag no-text-decoration" >workflow</a> <a href="/tags/programming/" class="post-tag no-text-decoration" >programming</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Building an Intelligent Emacs - Ian Y.E. Pan&url=https://ianyepan.github.io/posts/emacs-ide/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Building an Intelligent Emacs - Ian Y.E. Pan&u=https://ianyepan.github.io/posts/emacs-ide/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Building an Intelligent Emacs - Ian Y.E. Pan&url=https://ianyepan.github.io/posts/emacs-ide/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/system-default-monospace-fonts-pt1/">Gentle Intro to System Default Monospace Fonts (Part 1/2)</a><li><a href="/posts/cpp-notes-pt2/">A Tour of C++ - Reading Notes (Part 2/2)</a><li><a href="/posts/cpp-notes-pt1/">A Tour of C++ - Reading Notes (Part 1/2)</a><li><a href="/posts/c-web-server/">Building a Simple Web Server in C - an open source project</a><li><a href="/posts/sticky-notes/">Syncing Sticky Notes Between Laptop and Mobile</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/tips/">tips</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/emacs/">emacs</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/workflow/">workflow</a> <a class="post-tag" href="/tags/chinese/">chinese</a> <a class="post-tag" href="/tags/fonts/">fonts</a> <a class="post-tag" href="/tags/essay/">essay</a> <a class="post-tag" href="/tags/fragrance/">fragrance</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/emacs-emojis/"><div class="card-body"> <span class="timeago small" > Feb 17, 2022 <i class="unloaded">2022-02-17T11:18:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Native Emojis in Emacs</h3><div class="text-muted small"><p> This short post will help you set up emoji support in Emacs. First, let’s see the results: Emacs showing emojis Step one, you must have an emoji font installed. I really adore the new fluent de...</p></div></div></a></div><div class="card"> <a href="/posts/emacs-git-gutter/"><div class="card-body"> <span class="timeago small" > Feb 18, 2022 <i class="unloaded">2022-02-18T03:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Git Gutter in Emacs</h3><div class="text-muted small"><p> When I first started programming using Visual Studio Code, I’ve benefited much from the git gutter indicators that show added/deleted/modified code blocks that haven’t been committed by git. This a...</p></div></div></a></div><div class="card"> <a href="/posts/emacs-profiling/"><div class="card-body"> <span class="timeago small" > Mar 12, 2022 <i class="unloaded">2022-03-12T12:30:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Profiling Performance in Emacs</h3><div class="text-muted small"><p> This short blog post showcases the builtin “performance profiling” support that Emacs has. TLDR: all you need to know are 3 commands: M-x profiler-start, M-x profiler-stop, and M-x profiler-repo...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/cpp-notes-pt2/" class="btn btn-outline-primary" prompt="Older"><p>A Tour of C++ - Reading Notes (Part 2/2)</p></a> <a href="/posts/emacs-emojis/" class="btn btn-outline-primary" prompt="Newer"><p>Native Emojis in Emacs</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/ianyepan">Ian Y.E. Pan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Source code to this website can be found <a href="https://github.com/ianyepan/ianyepan.github.io">here.</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/tips/">tips</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/emacs/">emacs</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/workflow/">workflow</a> <a class="post-tag" href="/tags/chinese/">chinese</a> <a class="post-tag" href="/tags/fonts/">fonts</a> <a class="post-tag" href="/tags/essay/">essay</a> <a class="post-tag" href="/tags/fragrance/">fragrance</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ianyepan.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
